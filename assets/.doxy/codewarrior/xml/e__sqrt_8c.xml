<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="e__sqrt_8c" kind="file" language="C++">
    <compoundname>e_sqrt.c</compoundname>
    <includes refid="math_8h" local="no">math.h</includes>
    <includes refid="fdlibm_8h" local="yes">fdlibm.h</includes>
    <incdepgraph>
      <node id="3">
        <label>cmath</label>
        <link refid="cmath"/>
      </node>
      <node id="2">
        <label>math.h</label>
        <link refid="math_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>e_sqrt.c</label>
        <link refid="e__sqrt_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>fdlibm.h</label>
        <link refid="fdlibm_8h"/>
      </node>
    </incdepgraph>
    <sectiondef kind="var">
      <memberdef kind="variable" id="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" prot="public" static="yes" mutable="no">
        <type>double</type>
        <definition>double one</definition>
        <argsstring></argsstring>
        <name>one</name>
        <initializer>= 1.0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="decomp/CodeWarrior/PowerPC_EABI_Support/Msl/MSL_C/MSL_Common_Embedded/Math/Double_precision/e_sqrt.c" line="91" column="13" bodyfile="decomp/CodeWarrior/PowerPC_EABI_Support/Msl/MSL_C/MSL_Common_Embedded/Math/Double_precision/e_sqrt.c" bodystart="91" bodyend="-1"/>
        <referencedby refid="e__sqrt_8c_1a1c81b6b05efb3c03f83bcaaf18be12ad" compoundref="e__sqrt_8c" startline="97" endline="205">__ieee754_sqrt</referencedby>
      </memberdef>
      <memberdef kind="variable" id="e__sqrt_8c_1a480d71e681b85582a50de33f2411e74d" prot="public" static="yes" mutable="no">
        <type>double</type>
        <definition>double tiny</definition>
        <argsstring></argsstring>
        <name>tiny</name>
        <initializer>=1.0e-300</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="decomp/CodeWarrior/PowerPC_EABI_Support/Msl/MSL_C/MSL_Common_Embedded/Math/Double_precision/e_sqrt.c" line="91" column="17" bodyfile="decomp/CodeWarrior/PowerPC_EABI_Support/Msl/MSL_C/MSL_Common_Embedded/Math/Double_precision/e_sqrt.c" bodystart="91" bodyend="-1"/>
        <referencedby refid="e__sqrt_8c_1a1c81b6b05efb3c03f83bcaaf18be12ad" compoundref="e__sqrt_8c" startline="97" endline="205">__ieee754_sqrt</referencedby>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="e__sqrt_8c_1a1c81b6b05efb3c03f83bcaaf18be12ad" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double __ieee754_sqrt</definition>
        <argsstring>(double x)</argsstring>
        <name>__ieee754_sqrt</name>
        <param>
          <type>double</type>
          <declname>x</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="decomp/CodeWarrior/PowerPC_EABI_Support/Msl/MSL_C/MSL_Common_Embedded/Math/Double_precision/e_sqrt.c" line="97" column="8" bodyfile="decomp/CodeWarrior/PowerPC_EABI_Support/Msl/MSL_C/MSL_Common_Embedded/Math/Double_precision/e_sqrt.c" bodystart="97" bodyend="205"/>
        <references refid="math__config_8h_1a5934764962e1cdd0b50bec228537a127" compoundref="math__config_8h" startline="15">__HI</references>
        <references refid="math__config_8h_1a3e811eb5592161550c18c0e102d39d45" compoundref="math__config_8h" startline="14">__LO</references>
        <references refid="errno_8c_1a1a73eedabc7bba1fcfed488f5ea2bfb6" compoundref="errno_8c" startline="18">errno</references>
        <references refid="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" compoundref="e__sqrt_8c" startline="91">one</references>
        <references refid="e__lgamma__r_8c_1aa857ed5c081381af534715a410da6fa3" compoundref="e__lgamma__r_8c" startline="137">s0</references>
        <references refid="e__lgamma__r_8c_1a2871a1979bfda417aeb0da473e54ce00" compoundref="e__lgamma__r_8c" startline="138">s1</references>
        <references refid="e__lgamma__r_8c_1a59692051ca9586d10f35f14d574229da" compoundref="e__lgamma__r_8c" startline="112">t1</references>
        <references refid="e__sqrt_8c_1a480d71e681b85582a50de33f2411e74d" compoundref="e__sqrt_8c" startline="91">tiny</references>
        <referencedby refid="w__sqrt_8c_1ab87521a75ef827a85807f89a6c10629a" compoundref="w__sqrt_8c" startline="35" endline="53">sqrt</referencedby>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>_No_Floating_Point<sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="math_8h" kindref="compound">math.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>@(#)e_sqrt.c<sp/>1.2<sp/>95/01/04<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>$Id:<sp/>e_sqrt.c,v<sp/>1.3.4.1<sp/>1999/12/06<sp/>19:47:53<sp/>fassiott<sp/>Exp<sp/>$<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>====================================================</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(C)<sp/>1993<sp/>by<sp/>Sun<sp/>Microsystems,<sp/>Inc.<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>Developed<sp/>at<sp/>SunPro,<sp/>a<sp/>Sun<sp/>Microsystems,<sp/>Inc.<sp/>business.</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>Permission<sp/>to<sp/>use,<sp/>copy,<sp/>modify,<sp/>and<sp/>distribute<sp/>this</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>software<sp/>is<sp/>freely<sp/>granted,<sp/>provided<sp/>that<sp/>this<sp/>notice<sp/></highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>is<sp/>preserved.</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>====================================================</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>__ieee754_sqrt(x)</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>Return<sp/>correctly<sp/>rounded<sp/>sqrt.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------------------------</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/>Use<sp/>the<sp/>hardware<sp/>sqrt<sp/>if<sp/>you<sp/>have<sp/>one<sp/>|</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------------------------</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>Method:<sp/></highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/><sp/><sp/>Bit<sp/>by<sp/>bit<sp/>method<sp/>using<sp/>integer<sp/>arithmetic.<sp/>(Slow,<sp/>but<sp/>portable)<sp/></highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/><sp/><sp/>1.<sp/>Normalization</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/><sp/>Scale<sp/>x<sp/>to<sp/>y<sp/>in<sp/>[1,4)<sp/>with<sp/>even<sp/>powers<sp/>of<sp/>2:<sp/></highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/><sp/>find<sp/>an<sp/>integer<sp/>k<sp/>such<sp/>that<sp/><sp/>1<sp/>&lt;=<sp/>(y=x*2^(2k))<sp/>&lt;<sp/>4,<sp/>then</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>sqrt(x)<sp/>=<sp/>2^k<sp/>*<sp/>sqrt(y)</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2.<sp/>Bit<sp/>by<sp/>bit<sp/>computation</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/><sp/>Let<sp/>q<sp/><sp/>=<sp/>sqrt(y)<sp/>truncated<sp/>to<sp/>i<sp/>bit<sp/>after<sp/>binary<sp/>point<sp/>(q<sp/>=<sp/>1),</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i+1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>s<sp/><sp/>=<sp/>2*q<sp/>,<sp/>and<sp/><sp/>y<sp/><sp/>=<sp/><sp/>2<sp/><sp/><sp/>*<sp/>(<sp/>y<sp/>-<sp/>q<sp/><sp/>).<sp/><sp/><sp/><sp/><sp/>(1)</highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*<sp/><sp/>To<sp/>compute<sp/>q<sp/><sp/><sp/><sp/>from<sp/>q<sp/>,<sp/>one<sp/>checks<sp/>whether<sp/></highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i+1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-(i+1)<sp/>2</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(q<sp/>+<sp/>2<sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>&lt;=<sp/>y.<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(2)</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-(i+1)</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*<sp/><sp/>If<sp/>(2)<sp/>is<sp/>false,<sp/>then<sp/>q<sp/><sp/><sp/>=<sp/>q<sp/>;<sp/>otherwise<sp/>q<sp/><sp/><sp/>=<sp/>q<sp/><sp/>+<sp/>2<sp/><sp/><sp/><sp/><sp/><sp/>.</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i+1<sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i+1<sp/><sp/><sp/>i</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/><sp/>With<sp/>some<sp/>algebric<sp/>manipulation,<sp/>it<sp/>is<sp/>not<sp/>difficult<sp/>to<sp/>see</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*<sp/><sp/>that<sp/>(2)<sp/>is<sp/>equivalent<sp/>to<sp/></highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-(i+1)</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/><sp/>+<sp/><sp/>2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;=<sp/>y<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(3)</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>advantage<sp/>of<sp/>(3)<sp/>is<sp/>that<sp/>s<sp/><sp/>and<sp/>y<sp/><sp/>can<sp/>be<sp/>computed<sp/>by<sp/></highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/>i</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*<sp/><sp/>the<sp/>following<sp/>recurrence<sp/>formula:</highlight></codeline>
<codeline lineno="53"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(3)<sp/>is<sp/>false</highlight></codeline>
<codeline lineno="54"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>s<sp/><sp/><sp/><sp/><sp/>=<sp/><sp/>s<sp/><sp/>,<sp/><sp/><sp/>y<sp/><sp/><sp/><sp/>=<sp/>y<sp/><sp/><sp/>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(4)</highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>i+1<sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/>i+1<sp/><sp/><sp/><sp/>i</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>otherwise,</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-(i+1)</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>s<sp/><sp/><sp/><sp/><sp/>=<sp/><sp/>s<sp/><sp/>+<sp/>2<sp/><sp/>,<sp/><sp/>y<sp/><sp/><sp/><sp/>=<sp/>y<sp/><sp/>-<sp/><sp/>s<sp/><sp/>-<sp/>2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(5)</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i+1<sp/><sp/><sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i+1<sp/><sp/><sp/><sp/>i<sp/><sp/><sp/><sp/><sp/>i</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*<sp/><sp/>One<sp/>may<sp/>easily<sp/>use<sp/>induction<sp/>to<sp/>prove<sp/>(4)<sp/>and<sp/>(5).<sp/></highlight></codeline>
<codeline lineno="64"><highlight class="comment"><sp/>*<sp/><sp/>Note.<sp/>Since<sp/>the<sp/>left<sp/>hand<sp/>side<sp/>of<sp/>(3)<sp/>contain<sp/>only<sp/>i+2<sp/>bits,</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>it<sp/>does<sp/>not<sp/>necessary<sp/>to<sp/>do<sp/>a<sp/>full<sp/>(53-bit)<sp/>comparison<sp/></highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in<sp/>(3).</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*<sp/><sp/><sp/>3.<sp/>Final<sp/>rounding</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*<sp/><sp/>After<sp/>generating<sp/>the<sp/>53<sp/>bits<sp/>result,<sp/>we<sp/>compute<sp/>one<sp/>more<sp/>bit.</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*<sp/><sp/>Together<sp/>with<sp/>the<sp/>remainder,<sp/>we<sp/>can<sp/>decide<sp/>whether<sp/>the</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*<sp/><sp/>result<sp/>is<sp/>exact,<sp/>bigger<sp/>than<sp/>1/2ulp,<sp/>or<sp/>less<sp/>than<sp/>1/2ulp</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/><sp/>(it<sp/>will<sp/>never<sp/>equal<sp/>to<sp/>1/2ulp).</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>rounding<sp/>mode<sp/>can<sp/>be<sp/>detected<sp/>by<sp/>checking<sp/>whether</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/><sp/>big<sp/>+<sp/>tiny<sp/>is<sp/>equal<sp/>to<sp/>big,<sp/>and<sp/>whether<sp/>big<sp/>-<sp/>tiny<sp/>is</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/><sp/>equal<sp/>to<sp/>big<sp/>for<sp/>some<sp/>floating<sp/>point<sp/>number<sp/>&quot;big&quot;<sp/>and<sp/>&quot;tiny&quot;.</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/>*<sp/>Special<sp/>cases:</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/><sp/>sqrt(+-0)<sp/>=<sp/>+-0<sp/><sp/><sp/><sp/><sp/>...<sp/>exact</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*<sp/><sp/>sqrt(inf)<sp/>=<sp/>inf</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*<sp/><sp/>sqrt(-ve)<sp/>=<sp/>NaN<sp/><sp/><sp/><sp/><sp/>...<sp/>with<sp/>invalid<sp/>signal</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*<sp/><sp/>sqrt(NaN)<sp/>=<sp/>NaN<sp/><sp/><sp/><sp/><sp/>...<sp/>with<sp/>invalid<sp/>signal<sp/>for<sp/>signaling<sp/>NaN</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/>Other<sp/>methods<sp/>:<sp/>see<sp/>the<sp/>appended<sp/>file<sp/>at<sp/>the<sp/>end<sp/>of<sp/>the<sp/>program<sp/>below.</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*---------------</highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="fdlibm_8h" kindref="compound">fdlibm.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__STDC__</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" kindref="member">one</ref><sp/>=<sp/>1.0,<sp/><ref refid="e__sqrt_8c_1a480d71e681b85582a50de33f2411e74d" kindref="member">tiny</ref>=1.0e-300;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91" refid="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><ref refid="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" kindref="member">one</ref><sp/>=<sp/>1.0,<sp/><ref refid="e__sqrt_8c_1a480d71e681b85582a50de33f2411e74d" kindref="member">tiny</ref>=1.0e-300;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__STDC__</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="e__sqrt_8c_1a1c81b6b05efb3c03f83bcaaf18be12ad" kindref="member">__ieee754_sqrt</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>x)</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="e__sqrt_8c_1a1c81b6b05efb3c03f83bcaaf18be12ad" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="e__sqrt_8c_1a1c81b6b05efb3c03f83bcaaf18be12ad" kindref="member">__ieee754_sqrt</ref>(x)</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>x;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal">{</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/><sp/>const<sp/>double<sp/><sp/><sp/>one<sp/>=<sp/>1.0,<sp/>tiny=1.0e-300;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>z;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>sign<sp/>=<sp/>(int)0x80000000;<sp/></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/>r,<ref refid="e__lgamma__r_8c_1a59692051ca9586d10f35f14d574229da" kindref="member">t1</ref>,<ref refid="e__lgamma__r_8c_1a2871a1979bfda417aeb0da473e54ce00" kindref="member">s1</ref>,ix1,q1;</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ix0,<ref refid="e__lgamma__r_8c_1aa857ed5c081381af534715a410da6fa3" kindref="member">s0</ref>,q,m,t,i;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>ix0<sp/>=<sp/><ref refid="math__config_8h_1a5934764962e1cdd0b50bec228537a127" kindref="member">__HI</ref>(x);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>high<sp/>word<sp/>of<sp/>x<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>ix1<sp/>=<sp/><ref refid="math__config_8h_1a3e811eb5592161550c18c0e102d39d45" kindref="member">__LO</ref>(x);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>low<sp/>word<sp/>of<sp/>x<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>take<sp/>care<sp/>of<sp/>Inf<sp/>and<sp/>NaN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((ix0&amp;0x7ff00000)==0x7ff00000)<sp/>{<sp/><sp/></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#ifdef<sp/>__STDC__</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="errno_8c_1a1a73eedabc7bba1fcfed488f5ea2bfb6" kindref="member">errno</ref>=EDOM;<sp/><sp/></highlight><highlight class="comment">/*<sp/>mf--<sp/>added<sp/>to<sp/>conform<sp/>to<sp/>old<sp/>ANSI<sp/>standard<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#endif<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>x*x+x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>sqrt(NaN)=NaN,<sp/>sqrt(+inf)=+inf</highlight></codeline>
<codeline lineno="116"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sqrt(-inf)=sNaN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>take<sp/>care<sp/>of<sp/>zero<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ix0&lt;=0)<sp/>{</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(((ix0&amp;(~sign))|ix1)==0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>x;</highlight><highlight class="comment">/*<sp/>sqrt(+-0)<sp/>=<sp/>+-0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ix0&lt;0)</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>__STDC__</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="errno_8c_1a1a73eedabc7bba1fcfed488f5ea2bfb6" kindref="member">errno</ref>=EDOM;<sp/><sp/></highlight><highlight class="comment">/*<sp/>mf--<sp/>added<sp/>to<sp/>conform<sp/>to<sp/>old<sp/>ANSI<sp/>standard<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NAN;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>sqrt(-ve)<sp/>=<sp/>sNaN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>normalize<sp/>x<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>m<sp/>=<sp/>(ix0&gt;&gt;20);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(m==0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>subnormal<sp/>x<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(ix0==0)<sp/>{</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m<sp/>-=<sp/>21;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix0<sp/>|=<sp/>(ix1&gt;&gt;11);<sp/>ix1<sp/>&lt;&lt;=<sp/>21;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;(ix0&amp;0x00100000)==0;i++)<sp/>ix0&lt;&lt;=1;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m<sp/>-=<sp/>i-1;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix0<sp/>|=<sp/>(ix1&gt;&gt;(32-i));</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix1<sp/>&lt;&lt;=<sp/>i;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>m<sp/>-=<sp/>1023;<sp/><sp/></highlight><highlight class="comment">/*<sp/>unbias<sp/>exponent<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>ix0<sp/>=<sp/>(ix0&amp;0x000fffff)|0x00100000;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(m&amp;1){<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>odd<sp/>m,<sp/>double<sp/>x<sp/>to<sp/>make<sp/>it<sp/>even<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix0<sp/>+=<sp/>ix0<sp/>+<sp/>((ix1&amp;sign)&gt;&gt;31);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix1<sp/>+=<sp/>ix1;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>m<sp/>&gt;&gt;=<sp/>1;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>m<sp/>=<sp/>[m/2]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>generate<sp/>sqrt(x)<sp/>bit<sp/>by<sp/>bit<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>ix0<sp/>+=<sp/>ix0<sp/>+<sp/>((ix1&amp;sign)&gt;&gt;31);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>ix1<sp/>+=<sp/>ix1;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>q<sp/>=<sp/>q1<sp/>=<sp/><ref refid="e__lgamma__r_8c_1aa857ed5c081381af534715a410da6fa3" kindref="member">s0</ref><sp/>=<sp/><ref refid="e__lgamma__r_8c_1a2871a1979bfda417aeb0da473e54ce00" kindref="member">s1</ref><sp/>=<sp/>0;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[q,q1]<sp/>=<sp/>sqrt(x)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>r<sp/>=<sp/>0x00200000;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>r<sp/>=<sp/>moving<sp/>bit<sp/>from<sp/>right<sp/>to<sp/>left<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(r!=0)<sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>=<sp/><ref refid="e__lgamma__r_8c_1aa857ed5c081381af534715a410da6fa3" kindref="member">s0</ref>+r;<sp/></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t&lt;=ix0)<sp/>{<sp/></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="e__lgamma__r_8c_1aa857ed5c081381af534715a410da6fa3" kindref="member">s0</ref><sp/><sp/><sp/>=<sp/>t+r;<sp/></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix0<sp/>-=<sp/>t;<sp/></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q<sp/><sp/><sp/>+=<sp/>r;<sp/></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix0<sp/>+=<sp/>ix0<sp/>+<sp/>((ix1&amp;sign)&gt;&gt;31);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix1<sp/>+=<sp/>ix1;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r&gt;&gt;=1;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>r<sp/>=<sp/>sign;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(r!=0)<sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="e__lgamma__r_8c_1a59692051ca9586d10f35f14d574229da" kindref="member">t1</ref><sp/>=<sp/><ref refid="e__lgamma__r_8c_1a2871a1979bfda417aeb0da473e54ce00" kindref="member">s1</ref>+r;<sp/></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/><sp/>=<sp/><ref refid="e__lgamma__r_8c_1aa857ed5c081381af534715a410da6fa3" kindref="member">s0</ref>;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((t&lt;ix0)||((t==ix0)&amp;&amp;(<ref refid="e__lgamma__r_8c_1a59692051ca9586d10f35f14d574229da" kindref="member">t1</ref>&lt;=ix1)))<sp/>{<sp/></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="e__lgamma__r_8c_1a2871a1979bfda417aeb0da473e54ce00" kindref="member">s1</ref><sp/><sp/>=<sp/><ref refid="e__lgamma__r_8c_1a59692051ca9586d10f35f14d574229da" kindref="member">t1</ref>+r;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(((<ref refid="e__lgamma__r_8c_1a59692051ca9586d10f35f14d574229da" kindref="member">t1</ref>&amp;sign)==sign)&amp;&amp;(<ref refid="e__lgamma__r_8c_1a2871a1979bfda417aeb0da473e54ce00" kindref="member">s1</ref>&amp;sign)==0)<sp/><ref refid="e__lgamma__r_8c_1aa857ed5c081381af534715a410da6fa3" kindref="member">s0</ref><sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix0<sp/>-=<sp/>t;</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ix1<sp/>&lt;<sp/><ref refid="e__lgamma__r_8c_1a59692051ca9586d10f35f14d574229da" kindref="member">t1</ref>)<sp/>ix0<sp/>-=<sp/>1;</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix1<sp/>-=<sp/><ref refid="e__lgamma__r_8c_1a59692051ca9586d10f35f14d574229da" kindref="member">t1</ref>;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q1<sp/><sp/>+=<sp/>r;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix0<sp/>+=<sp/>ix0<sp/>+<sp/>((ix1&amp;sign)&gt;&gt;31);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ix1<sp/>+=<sp/>ix1;</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r&gt;&gt;=1;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>use<sp/>floating<sp/>add<sp/>to<sp/>find<sp/>out<sp/>rounding<sp/>direction<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((ix0|ix1)!=0)<sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z<sp/>=<sp/><ref refid="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" kindref="member">one</ref>-<ref refid="e__sqrt_8c_1a480d71e681b85582a50de33f2411e74d" kindref="member">tiny</ref>;<sp/></highlight><highlight class="comment">/*<sp/>trigger<sp/>inexact<sp/>flag<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(z&gt;=<ref refid="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" kindref="member">one</ref>)<sp/>{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z<sp/>=<sp/><ref refid="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" kindref="member">one</ref>+<ref refid="e__sqrt_8c_1a480d71e681b85582a50de33f2411e74d" kindref="member">tiny</ref>;</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(q1==(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal">)0xffffffff)<sp/>{<sp/>q1=0;<sp/>q<sp/>+=<sp/>1;}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(z&gt;<ref refid="e__sqrt_8c_1aa4767c9b14591d5e6d3b3de6ec20b6bb" kindref="member">one</ref>)<sp/>{</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(q1==(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal">)0xfffffffe)<sp/>q+=1;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q1+=2;<sp/></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q1<sp/>+=<sp/>(q1&amp;1);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>ix0<sp/>=<sp/>(q&gt;&gt;1)+0x3fe00000;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>ix1<sp/>=<sp/><sp/>q1&gt;&gt;1;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((q&amp;1)==1)<sp/>ix1<sp/>|=<sp/>sign;</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/>ix0<sp/>+=<sp/>(m<sp/>&lt;&lt;20);</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="math__config_8h_1a5934764962e1cdd0b50bec228537a127" kindref="member">__HI</ref>(z)<sp/>=<sp/>ix0;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="math__config_8h_1a3e811eb5592161550c18c0e102d39d45" kindref="member">__LO</ref>(z)<sp/>=<sp/>ix1;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>z;</highlight></codeline>
<codeline lineno="205"><highlight class="normal">}</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="208"><highlight class="comment">Other<sp/>methods<sp/><sp/>(use<sp/>floating-point<sp/>arithmetic)</highlight></codeline>
<codeline lineno="209"><highlight class="comment">-------------</highlight></codeline>
<codeline lineno="210"><highlight class="comment">(This<sp/>is<sp/>a<sp/>copy<sp/>of<sp/>a<sp/>drafted<sp/>paper<sp/>by<sp/>Prof<sp/>W.<sp/>Kahan<sp/></highlight></codeline>
<codeline lineno="211"><highlight class="comment">and<sp/>K.C.<sp/>Ng,<sp/>written<sp/>in<sp/>May,<sp/>1986)</highlight></codeline>
<codeline lineno="212"><highlight class="comment"></highlight></codeline>
<codeline lineno="213"><highlight class="comment"><sp/><sp/><sp/><sp/>Two<sp/>algorithms<sp/>are<sp/>given<sp/>here<sp/>to<sp/>implement<sp/>sqrt(x)<sp/></highlight></codeline>
<codeline lineno="214"><highlight class="comment"><sp/><sp/><sp/><sp/>(IEEE<sp/>double<sp/>precision<sp/>arithmetic)<sp/>in<sp/>software.</highlight></codeline>
<codeline lineno="215"><highlight class="comment"><sp/><sp/><sp/><sp/>Both<sp/>supply<sp/>sqrt(x)<sp/>correctly<sp/>rounded.<sp/>The<sp/>first<sp/>algorithm<sp/>(in</highlight></codeline>
<codeline lineno="216"><highlight class="comment"><sp/><sp/><sp/><sp/>Section<sp/>A)<sp/>uses<sp/>newton<sp/>iterations<sp/>and<sp/>involves<sp/>four<sp/>divisions.</highlight></codeline>
<codeline lineno="217"><highlight class="comment"><sp/><sp/><sp/><sp/>The<sp/>second<sp/>one<sp/>uses<sp/>reciproot<sp/>iterations<sp/>to<sp/>avoid<sp/>division,<sp/>but</highlight></codeline>
<codeline lineno="218"><highlight class="comment"><sp/><sp/><sp/><sp/>requires<sp/>more<sp/>multiplications.<sp/>Both<sp/>algorithms<sp/>need<sp/>the<sp/>ability</highlight></codeline>
<codeline lineno="219"><highlight class="comment"><sp/><sp/><sp/><sp/>to<sp/>chop<sp/>results<sp/>of<sp/>arithmetic<sp/>operations<sp/>instead<sp/>of<sp/>round<sp/>them,<sp/></highlight></codeline>
<codeline lineno="220"><highlight class="comment"><sp/><sp/><sp/><sp/>and<sp/>the<sp/>INEXACT<sp/>flag<sp/>to<sp/>indicate<sp/>when<sp/>an<sp/>arithmetic<sp/>operation</highlight></codeline>
<codeline lineno="221"><highlight class="comment"><sp/><sp/><sp/><sp/>is<sp/>executed<sp/>exactly<sp/>with<sp/>no<sp/>roundoff<sp/>error,<sp/>all<sp/>part<sp/>of<sp/>the<sp/></highlight></codeline>
<codeline lineno="222"><highlight class="comment"><sp/><sp/><sp/><sp/>standard<sp/>(IEEE<sp/>754-1985).<sp/>The<sp/>ability<sp/>to<sp/>perform<sp/>shift,<sp/>add,</highlight></codeline>
<codeline lineno="223"><highlight class="comment"><sp/><sp/><sp/><sp/>subtract<sp/>and<sp/>logical<sp/>AND<sp/>operations<sp/>upon<sp/>32-bit<sp/>words<sp/>is<sp/>needed</highlight></codeline>
<codeline lineno="224"><highlight class="comment"><sp/><sp/><sp/><sp/>too,<sp/>though<sp/>not<sp/>part<sp/>of<sp/>the<sp/>standard.</highlight></codeline>
<codeline lineno="225"><highlight class="comment"></highlight></codeline>
<codeline lineno="226"><highlight class="comment">A.<sp/><sp/>sqrt(x)<sp/>by<sp/>Newton<sp/>Iteration</highlight></codeline>
<codeline lineno="227"><highlight class="comment"></highlight></codeline>
<codeline lineno="228"><highlight class="comment"><sp/><sp/><sp/>(1)<sp/><sp/>Initial<sp/>approximation</highlight></codeline>
<codeline lineno="229"><highlight class="comment"></highlight></codeline>
<codeline lineno="230"><highlight class="comment"><sp/><sp/><sp/><sp/>Let<sp/>x0<sp/>and<sp/>x1<sp/>be<sp/>the<sp/>leading<sp/>and<sp/>the<sp/>trailing<sp/>32-bit<sp/>words<sp/>of</highlight></codeline>
<codeline lineno="231"><highlight class="comment"><sp/><sp/><sp/><sp/>a<sp/>floating<sp/>point<sp/>number<sp/>x<sp/>(in<sp/>IEEE<sp/>double<sp/>format)<sp/>respectively<sp/></highlight></codeline>
<codeline lineno="232"><highlight class="comment"></highlight></codeline>
<codeline lineno="233"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1<sp/><sp/><sp/><sp/>11<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>52<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...widths</highlight></codeline>
<codeline lineno="234"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------------------------------------</highlight></codeline>
<codeline lineno="235"><highlight class="comment"><sp/><sp/><sp/><sp/>x:<sp/>|s|<sp/><sp/><sp/><sp/>e<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="236"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------------------------------------</highlight></codeline>
<codeline lineno="237"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msb<sp/><sp/><sp/><sp/>lsb<sp/><sp/>msb<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lsb<sp/>...order</highlight></codeline>
<codeline lineno="238"><highlight class="comment"></highlight></codeline>
<codeline lineno="239"><highlight class="comment"><sp/></highlight></codeline>
<codeline lineno="240"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------</highlight></codeline>
<codeline lineno="241"><highlight class="comment"><sp/><sp/><sp/><sp/>x0:<sp/><sp/>|s|<sp/><sp/><sp/>e<sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/>f1<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/>x1:<sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="242"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>------------------------</highlight></codeline>
<codeline lineno="243"><highlight class="comment"></highlight></codeline>
<codeline lineno="244"><highlight class="comment"><sp/><sp/><sp/><sp/>By<sp/>performing<sp/>shifts<sp/>and<sp/>subtracts<sp/>on<sp/>x0<sp/>and<sp/>x1<sp/>(both<sp/>regarded</highlight></codeline>
<codeline lineno="245"><highlight class="comment"><sp/><sp/><sp/><sp/>as<sp/>integers),<sp/>we<sp/>obtain<sp/>an<sp/>8-bit<sp/>approximation<sp/>of<sp/>sqrt(x)<sp/>as</highlight></codeline>
<codeline lineno="246"><highlight class="comment"><sp/><sp/><sp/><sp/>follows.</highlight></codeline>
<codeline lineno="247"><highlight class="comment"></highlight></codeline>
<codeline lineno="248"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k<sp/><sp/>:=<sp/>(x0&gt;&gt;1)<sp/>+<sp/>0x1ff80000;</highlight></codeline>
<codeline lineno="249"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y0<sp/>:=<sp/>k<sp/>-<sp/>T1[31&amp;(k&gt;&gt;15)].<sp/><sp/><sp/>...<sp/>y<sp/>~<sp/>sqrt(x)<sp/>to<sp/>8<sp/>bits</highlight></codeline>
<codeline lineno="250"><highlight class="comment"><sp/><sp/><sp/><sp/>Here<sp/>k<sp/>is<sp/>a<sp/>32-bit<sp/>integer<sp/>and<sp/>T1[]<sp/>is<sp/>an<sp/>integer<sp/>array<sp/>containing</highlight></codeline>
<codeline lineno="251"><highlight class="comment"><sp/><sp/><sp/><sp/>correction<sp/>terms.<sp/>Now<sp/>magically<sp/>the<sp/>floating<sp/>value<sp/>of<sp/>y<sp/>(y&apos;s</highlight></codeline>
<codeline lineno="252"><highlight class="comment"><sp/><sp/><sp/><sp/>leading<sp/>32-bit<sp/>word<sp/>is<sp/>y0,<sp/>the<sp/>value<sp/>of<sp/>its<sp/>trailing<sp/>word<sp/>is<sp/>0)</highlight></codeline>
<codeline lineno="253"><highlight class="comment"><sp/><sp/><sp/><sp/>approximates<sp/>sqrt(x)<sp/>to<sp/>almost<sp/>8-bit.</highlight></codeline>
<codeline lineno="254"><highlight class="comment"></highlight></codeline>
<codeline lineno="255"><highlight class="comment"><sp/><sp/><sp/><sp/>Value<sp/>of<sp/>T1:</highlight></codeline>
<codeline lineno="256"><highlight class="comment"><sp/><sp/><sp/><sp/>static<sp/>int<sp/>T1[32]=<sp/>{</highlight></codeline>
<codeline lineno="257"><highlight class="comment"><sp/><sp/><sp/><sp/>0,<sp/><sp/>1024,<sp/><sp/><sp/>3062,<sp/><sp/><sp/>5746,<sp/><sp/><sp/>9193,<sp/><sp/><sp/>13348,<sp/><sp/>18162,<sp/><sp/>23592,</highlight></codeline>
<codeline lineno="258"><highlight class="comment"><sp/><sp/><sp/><sp/>29598,<sp/><sp/>36145,<sp/><sp/>43202,<sp/><sp/>50740,<sp/><sp/>58733,<sp/><sp/>67158,<sp/><sp/>75992,<sp/><sp/>85215,</highlight></codeline>
<codeline lineno="259"><highlight class="comment"><sp/><sp/><sp/><sp/>83599,<sp/><sp/>71378,<sp/><sp/>60428,<sp/><sp/>50647,<sp/><sp/>41945,<sp/><sp/>34246,<sp/><sp/>27478,<sp/><sp/>21581,</highlight></codeline>
<codeline lineno="260"><highlight class="comment"><sp/><sp/><sp/><sp/>16499,<sp/><sp/>12183,<sp/><sp/>8588,<sp/><sp/><sp/>5674,<sp/><sp/><sp/>3403,<sp/><sp/><sp/>1742,<sp/><sp/><sp/>661,<sp/><sp/><sp/><sp/>130,};</highlight></codeline>
<codeline lineno="261"><highlight class="comment"></highlight></codeline>
<codeline lineno="262"><highlight class="comment"><sp/><sp/><sp/><sp/>(2)<sp/>Iterative<sp/>refinement</highlight></codeline>
<codeline lineno="263"><highlight class="comment"></highlight></codeline>
<codeline lineno="264"><highlight class="comment"><sp/><sp/><sp/><sp/>Apply<sp/>Heron&apos;s<sp/>rule<sp/>three<sp/>times<sp/>to<sp/>y,<sp/>we<sp/>have<sp/>y<sp/>approximates<sp/></highlight></codeline>
<codeline lineno="265"><highlight class="comment"><sp/><sp/><sp/><sp/>sqrt(x)<sp/>to<sp/>within<sp/>1<sp/>ulp<sp/>(Unit<sp/>in<sp/>the<sp/>Last<sp/>Place):</highlight></codeline>
<codeline lineno="266"><highlight class="comment"></highlight></codeline>
<codeline lineno="267"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>(y+x/y)/2<sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>almost<sp/>17<sp/>sig.<sp/>bits</highlight></codeline>
<codeline lineno="268"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>(y+x/y)/2<sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>almost<sp/>35<sp/>sig.<sp/>bits</highlight></codeline>
<codeline lineno="269"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>y-(y-x/y)/2<sp/><sp/><sp/><sp/>...<sp/>within<sp/>1<sp/>ulp</highlight></codeline>
<codeline lineno="270"><highlight class="comment"></highlight></codeline>
<codeline lineno="271"><highlight class="comment"></highlight></codeline>
<codeline lineno="272"><highlight class="comment"><sp/><sp/><sp/><sp/>Remark<sp/>1.</highlight></codeline>
<codeline lineno="273"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Another<sp/>way<sp/>to<sp/>improve<sp/>y<sp/>to<sp/>within<sp/>1<sp/>ulp<sp/>is:</highlight></codeline>
<codeline lineno="274"><highlight class="comment"></highlight></codeline>
<codeline lineno="275"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>(y+x/y)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>almost<sp/>17<sp/>sig.<sp/>bits<sp/>to<sp/>2*sqrt(x)</highlight></codeline>
<codeline lineno="276"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>y<sp/>-<sp/>0x00100006<sp/>...<sp/>almost<sp/>18<sp/>sig.<sp/>bits<sp/>to<sp/>sqrt(x)</highlight></codeline>
<codeline lineno="277"><highlight class="comment"></highlight></codeline>
<codeline lineno="278"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2</highlight></codeline>
<codeline lineno="279"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(x-y<sp/>)*y</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>y<sp/>+<sp/>2*<sp/>----------<sp/><sp/>...within<sp/>1<sp/>ulp</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3y<sp/><sp/>+<sp/>x</highlight></codeline>
<codeline lineno="283"><highlight class="comment"></highlight></codeline>
<codeline lineno="284"><highlight class="comment"></highlight></codeline>
<codeline lineno="285"><highlight class="comment"><sp/><sp/><sp/><sp/>This<sp/>formula<sp/>has<sp/>one<sp/>division<sp/>fewer<sp/>than<sp/>the<sp/>one<sp/>above;<sp/>however,</highlight></codeline>
<codeline lineno="286"><highlight class="comment"><sp/><sp/><sp/><sp/>it<sp/>requires<sp/>more<sp/>multiplications<sp/>and<sp/>additions.<sp/>Also<sp/>x<sp/>must<sp/>be</highlight></codeline>
<codeline lineno="287"><highlight class="comment"><sp/><sp/><sp/><sp/>scaled<sp/>in<sp/>advance<sp/>to<sp/>avoid<sp/>spurious<sp/>overflow<sp/>in<sp/>evaluating<sp/>the</highlight></codeline>
<codeline lineno="288"><highlight class="comment"><sp/><sp/><sp/><sp/>expression<sp/>3y*y+x.<sp/>Hence<sp/>it<sp/>is<sp/>not<sp/>recommended<sp/>uless<sp/>division</highlight></codeline>
<codeline lineno="289"><highlight class="comment"><sp/><sp/><sp/><sp/>is<sp/>slow.<sp/>If<sp/>division<sp/>is<sp/>very<sp/>slow,<sp/>then<sp/>one<sp/>should<sp/>use<sp/>the<sp/></highlight></codeline>
<codeline lineno="290"><highlight class="comment"><sp/><sp/><sp/><sp/>reciproot<sp/>algorithm<sp/>given<sp/>in<sp/>section<sp/>B.</highlight></codeline>
<codeline lineno="291"><highlight class="comment"></highlight></codeline>
<codeline lineno="292"><highlight class="comment"><sp/><sp/><sp/><sp/>(3)<sp/>Final<sp/>adjustment</highlight></codeline>
<codeline lineno="293"><highlight class="comment"></highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/><sp/><sp/><sp/>By<sp/>twiddling<sp/>y&apos;s<sp/>last<sp/>bit<sp/>it<sp/>is<sp/>possible<sp/>to<sp/>force<sp/>y<sp/>to<sp/>be<sp/></highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/><sp/><sp/><sp/>correctly<sp/>rounded<sp/>according<sp/>to<sp/>the<sp/>prevailing<sp/>rounding<sp/>mode</highlight></codeline>
<codeline lineno="296"><highlight class="comment"><sp/><sp/><sp/><sp/>as<sp/>follows.<sp/>Let<sp/>r<sp/>and<sp/>i<sp/>be<sp/>copies<sp/>of<sp/>the<sp/>rounding<sp/>mode<sp/>and</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/><sp/><sp/><sp/>inexact<sp/>flag<sp/>before<sp/>entering<sp/>the<sp/>square<sp/>root<sp/>program.<sp/>Also<sp/>we</highlight></codeline>
<codeline lineno="298"><highlight class="comment"><sp/><sp/><sp/><sp/>use<sp/>the<sp/>expression<sp/>y+-ulp<sp/>for<sp/>the<sp/>next<sp/>representable<sp/>floating</highlight></codeline>
<codeline lineno="299"><highlight class="comment"><sp/><sp/><sp/><sp/>numbers<sp/>(up<sp/>and<sp/>down)<sp/>of<sp/>y.<sp/>Note<sp/>that<sp/>y+-ulp<sp/>=<sp/>either<sp/>fixed</highlight></codeline>
<codeline lineno="300"><highlight class="comment"><sp/><sp/><sp/><sp/>point<sp/>y+-1,<sp/>or<sp/>multiply<sp/>y<sp/>by<sp/>nextafter(1,+-inf)<sp/>in<sp/>chopped</highlight></codeline>
<codeline lineno="301"><highlight class="comment"><sp/><sp/><sp/><sp/>mode.</highlight></codeline>
<codeline lineno="302"><highlight class="comment"></highlight></codeline>
<codeline lineno="303"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>:=<sp/>FALSE;<sp/>...<sp/>reset<sp/>INEXACT<sp/>flag<sp/>I</highlight></codeline>
<codeline lineno="304"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R<sp/>:=<sp/>RZ;<sp/><sp/><sp/><sp/>...<sp/>set<sp/>rounding<sp/>mode<sp/>to<sp/>round-toward-zero</highlight></codeline>
<codeline lineno="305"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z<sp/>:=<sp/>x/y;<sp/><sp/><sp/>...<sp/>chopped<sp/>quotient,<sp/>possibly<sp/>inexact</highlight></codeline>
<codeline lineno="306"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If(not<sp/>I)<sp/>then<sp/>{<sp/><sp/><sp/><sp/>...<sp/>if<sp/>the<sp/>quotient<sp/>is<sp/>exact</highlight></codeline>
<codeline lineno="307"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(z=y)<sp/>{</highlight></codeline>
<codeline lineno="308"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>:=<sp/>i;<sp/><sp/>...<sp/>restore<sp/>inexact<sp/>flag</highlight></codeline>
<codeline lineno="309"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R<sp/>:=<sp/>r;<sp/><sp/>...<sp/>restore<sp/>rounded<sp/>mode</highlight></codeline>
<codeline lineno="310"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>sqrt(x):=y.</highlight></codeline>
<codeline lineno="311"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>else<sp/>{</highlight></codeline>
<codeline lineno="312"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z<sp/>:=<sp/>z<sp/>-<sp/>ulp;<sp/><sp/><sp/>...<sp/>special<sp/>rounding</highlight></codeline>
<codeline lineno="313"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="315"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>:=<sp/>TRUE;<sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>sqrt(x)<sp/>is<sp/>inexact</highlight></codeline>
<codeline lineno="316"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>(r=RN)<sp/>then<sp/>z=z+ulp<sp/><sp/>...<sp/>rounded-to-nearest</highlight></codeline>
<codeline lineno="317"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>(r=RP)<sp/>then<sp/>{<sp/><sp/><sp/><sp/>...<sp/>round-toward-+inf</highlight></codeline>
<codeline lineno="318"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>y+ulp;<sp/>z=z+ulp;</highlight></codeline>
<codeline lineno="319"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>y+z;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>chopped<sp/>sum</highlight></codeline>
<codeline lineno="321"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y0:=y0-0x00100000;<sp/><sp/>...<sp/>y<sp/>:=<sp/>y/2<sp/>is<sp/>correctly<sp/>rounded.</highlight></codeline>
<codeline lineno="322"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>:=<sp/>i;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>restore<sp/>inexact<sp/>flag</highlight></codeline>
<codeline lineno="323"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R<sp/>:=<sp/>r;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>restore<sp/>rounded<sp/>mode</highlight></codeline>
<codeline lineno="324"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>sqrt(x):=y.</highlight></codeline>
<codeline lineno="325"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="326"><highlight class="comment"><sp/><sp/><sp/><sp/>(4)<sp/>Special<sp/>cases</highlight></codeline>
<codeline lineno="327"><highlight class="comment"></highlight></codeline>
<codeline lineno="328"><highlight class="comment"><sp/><sp/><sp/><sp/>Square<sp/>root<sp/>of<sp/>+inf,<sp/>+-0,<sp/>or<sp/>NaN<sp/>is<sp/>itself;</highlight></codeline>
<codeline lineno="329"><highlight class="comment"><sp/><sp/><sp/><sp/>Square<sp/>root<sp/>of<sp/>a<sp/>negative<sp/>number<sp/>is<sp/>NaN<sp/>with<sp/>invalid<sp/>signal.</highlight></codeline>
<codeline lineno="330"><highlight class="comment"></highlight></codeline>
<codeline lineno="331"><highlight class="comment"></highlight></codeline>
<codeline lineno="332"><highlight class="comment">B.<sp/><sp/>sqrt(x)<sp/>by<sp/>Reciproot<sp/>Iteration</highlight></codeline>
<codeline lineno="333"><highlight class="comment"></highlight></codeline>
<codeline lineno="334"><highlight class="comment"><sp/><sp/><sp/>(1)<sp/><sp/>Initial<sp/>approximation</highlight></codeline>
<codeline lineno="335"><highlight class="comment"></highlight></codeline>
<codeline lineno="336"><highlight class="comment"><sp/><sp/><sp/><sp/>Let<sp/>x0<sp/>and<sp/>x1<sp/>be<sp/>the<sp/>leading<sp/>and<sp/>the<sp/>trailing<sp/>32-bit<sp/>words<sp/>of</highlight></codeline>
<codeline lineno="337"><highlight class="comment"><sp/><sp/><sp/><sp/>a<sp/>floating<sp/>point<sp/>number<sp/>x<sp/>(in<sp/>IEEE<sp/>double<sp/>format)<sp/>respectively</highlight></codeline>
<codeline lineno="338"><highlight class="comment"><sp/><sp/><sp/><sp/>(see<sp/>section<sp/>A).<sp/>By<sp/>performing<sp/>shifs<sp/>and<sp/>subtracts<sp/>on<sp/>x0<sp/>and<sp/>y0,</highlight></codeline>
<codeline lineno="339"><highlight class="comment"><sp/><sp/><sp/><sp/>we<sp/>obtain<sp/>a<sp/>7.8-bit<sp/>approximation<sp/>of<sp/>1/sqrt(x)<sp/>as<sp/>follows.</highlight></codeline>
<codeline lineno="340"><highlight class="comment"></highlight></codeline>
<codeline lineno="341"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k<sp/>:=<sp/>0x5fe80000<sp/>-<sp/>(x0&gt;&gt;1);</highlight></codeline>
<codeline lineno="342"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y0:=<sp/>k<sp/>-<sp/>T2[63&amp;(k&gt;&gt;14)].<sp/><sp/><sp/><sp/>...<sp/>y<sp/>~<sp/>1/sqrt(x)<sp/>to<sp/>7.8<sp/>bits</highlight></codeline>
<codeline lineno="343"><highlight class="comment"></highlight></codeline>
<codeline lineno="344"><highlight class="comment"><sp/><sp/><sp/><sp/>Here<sp/>k<sp/>is<sp/>a<sp/>32-bit<sp/>integer<sp/>and<sp/>T2[]<sp/>is<sp/>an<sp/>integer<sp/>array<sp/></highlight></codeline>
<codeline lineno="345"><highlight class="comment"><sp/><sp/><sp/><sp/>containing<sp/>correction<sp/>terms.<sp/>Now<sp/>magically<sp/>the<sp/>floating</highlight></codeline>
<codeline lineno="346"><highlight class="comment"><sp/><sp/><sp/><sp/>value<sp/>of<sp/>y<sp/>(y&apos;s<sp/>leading<sp/>32-bit<sp/>word<sp/>is<sp/>y0,<sp/>the<sp/>value<sp/>of</highlight></codeline>
<codeline lineno="347"><highlight class="comment"><sp/><sp/><sp/><sp/>its<sp/>trailing<sp/>word<sp/>y1<sp/>is<sp/>set<sp/>to<sp/>zero)<sp/>approximates<sp/>1/sqrt(x)</highlight></codeline>
<codeline lineno="348"><highlight class="comment"><sp/><sp/><sp/><sp/>to<sp/>almost<sp/>7.8-bit.</highlight></codeline>
<codeline lineno="349"><highlight class="comment"></highlight></codeline>
<codeline lineno="350"><highlight class="comment"><sp/><sp/><sp/><sp/>Value<sp/>of<sp/>T2:</highlight></codeline>
<codeline lineno="351"><highlight class="comment"><sp/><sp/><sp/><sp/>static<sp/>int<sp/>T2[64]=<sp/>{</highlight></codeline>
<codeline lineno="352"><highlight class="comment"><sp/><sp/><sp/><sp/>0x1500,<sp/>0x2ef8,<sp/>0x4d67,<sp/>0x6b02,<sp/>0x87be,<sp/>0xa395,<sp/>0xbe7a,<sp/>0xd866,</highlight></codeline>
<codeline lineno="353"><highlight class="comment"><sp/><sp/><sp/><sp/>0xf14a,<sp/>0x1091b,0x11fcd,0x13552,0x14999,0x15c98,0x16e34,0x17e5f,</highlight></codeline>
<codeline lineno="354"><highlight class="comment"><sp/><sp/><sp/><sp/>0x18d03,0x19a01,0x1a545,0x1ae8a,0x1b5c4,0x1bb01,0x1bfde,0x1c28d,</highlight></codeline>
<codeline lineno="355"><highlight class="comment"><sp/><sp/><sp/><sp/>0x1c2de,0x1c0db,0x1ba73,0x1b11c,0x1a4b5,0x1953d,0x18266,0x16be0,</highlight></codeline>
<codeline lineno="356"><highlight class="comment"><sp/><sp/><sp/><sp/>0x1683e,0x179d8,0x18a4d,0x19992,0x1a789,0x1b445,0x1bf61,0x1c989,</highlight></codeline>
<codeline lineno="357"><highlight class="comment"><sp/><sp/><sp/><sp/>0x1d16d,0x1d77b,0x1dddf,0x1e2ad,0x1e5bf,0x1e6e8,0x1e654,0x1e3cd,</highlight></codeline>
<codeline lineno="358"><highlight class="comment"><sp/><sp/><sp/><sp/>0x1df2a,0x1d635,0x1cb16,0x1be2c,0x1ae4e,0x19bde,0x1868e,0x16e2e,</highlight></codeline>
<codeline lineno="359"><highlight class="comment"><sp/><sp/><sp/><sp/>0x1527f,0x1334a,0x11051,0xe951,<sp/>0xbe01,<sp/>0x8e0d,<sp/>0x5924,<sp/>0x1edd,};</highlight></codeline>
<codeline lineno="360"><highlight class="comment"></highlight></codeline>
<codeline lineno="361"><highlight class="comment"><sp/><sp/><sp/><sp/>(2)<sp/>Iterative<sp/>refinement</highlight></codeline>
<codeline lineno="362"><highlight class="comment"></highlight></codeline>
<codeline lineno="363"><highlight class="comment"><sp/><sp/><sp/><sp/>Apply<sp/>Reciproot<sp/>iteration<sp/>three<sp/>times<sp/>to<sp/>y<sp/>and<sp/>multiply<sp/>the</highlight></codeline>
<codeline lineno="364"><highlight class="comment"><sp/><sp/><sp/><sp/>result<sp/>by<sp/>x<sp/>to<sp/>get<sp/>an<sp/>approximation<sp/>z<sp/>that<sp/>matches<sp/>sqrt(x)</highlight></codeline>
<codeline lineno="365"><highlight class="comment"><sp/><sp/><sp/><sp/>to<sp/>about<sp/>1<sp/>ulp.<sp/>To<sp/>be<sp/>exact,<sp/>we<sp/>will<sp/>have<sp/></highlight></codeline>
<codeline lineno="366"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1ulp<sp/>&lt;<sp/>sqrt(x)-z&lt;1.0625ulp.</highlight></codeline>
<codeline lineno="367"><highlight class="comment"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="368"><highlight class="comment"><sp/><sp/><sp/><sp/>...<sp/>set<sp/>rounding<sp/>mode<sp/>to<sp/>Round-to-nearest</highlight></codeline>
<codeline lineno="369"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>y*(1.5-0.5*x*y*y)<sp/><sp/><sp/>...<sp/>almost<sp/>15<sp/>sig.<sp/>bits<sp/>to<sp/>1/sqrt(x)</highlight></codeline>
<codeline lineno="370"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:=<sp/>y*((1.5-2^-30)+0.5*x*y*y)...<sp/>about<sp/>29<sp/>sig.<sp/>bits<sp/>to<sp/>1/sqrt(x)</highlight></codeline>
<codeline lineno="371"><highlight class="comment"><sp/><sp/><sp/><sp/>...<sp/>special<sp/>arrangement<sp/>for<sp/>better<sp/>accuracy</highlight></codeline>
<codeline lineno="372"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z<sp/>:=<sp/>x*y<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>29<sp/>bits<sp/>to<sp/>sqrt(x),<sp/>with<sp/>z*y&lt;1</highlight></codeline>
<codeline lineno="373"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z<sp/>:=<sp/>z<sp/>+<sp/>0.5*z*(1-z*y)<sp/><sp/><sp/>...<sp/>about<sp/>1<sp/>ulp<sp/>to<sp/>sqrt(x)</highlight></codeline>
<codeline lineno="374"><highlight class="comment"></highlight></codeline>
<codeline lineno="375"><highlight class="comment"><sp/><sp/><sp/><sp/>Remark<sp/>2.<sp/>The<sp/>constant<sp/>1.5-2^-30<sp/>is<sp/>chosen<sp/>to<sp/>bias<sp/>the<sp/>error<sp/>so<sp/>that</highlight></codeline>
<codeline lineno="376"><highlight class="comment"><sp/><sp/><sp/><sp/>(a)<sp/>the<sp/>term<sp/>z*y<sp/>in<sp/>the<sp/>final<sp/>iteration<sp/>is<sp/>always<sp/>less<sp/>than<sp/>1;<sp/></highlight></codeline>
<codeline lineno="377"><highlight class="comment"><sp/><sp/><sp/><sp/>(b)<sp/>the<sp/>error<sp/>in<sp/>the<sp/>final<sp/>result<sp/>is<sp/>biased<sp/>upward<sp/>so<sp/>that</highlight></codeline>
<codeline lineno="378"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1<sp/>ulp<sp/>&lt;<sp/>sqrt(x)<sp/>-<sp/>z<sp/>&lt;<sp/>1.0625<sp/>ulp</highlight></codeline>
<codeline lineno="379"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instead<sp/>of<sp/>|sqrt(x)-z|&lt;1.03125ulp.</highlight></codeline>
<codeline lineno="380"><highlight class="comment"></highlight></codeline>
<codeline lineno="381"><highlight class="comment"><sp/><sp/><sp/><sp/>(3)<sp/>Final<sp/>adjustment</highlight></codeline>
<codeline lineno="382"><highlight class="comment"></highlight></codeline>
<codeline lineno="383"><highlight class="comment"><sp/><sp/><sp/><sp/>By<sp/>twiddling<sp/>y&apos;s<sp/>last<sp/>bit<sp/>it<sp/>is<sp/>possible<sp/>to<sp/>force<sp/>y<sp/>to<sp/>be<sp/></highlight></codeline>
<codeline lineno="384"><highlight class="comment"><sp/><sp/><sp/><sp/>correctly<sp/>rounded<sp/>according<sp/>to<sp/>the<sp/>prevailing<sp/>rounding<sp/>mode</highlight></codeline>
<codeline lineno="385"><highlight class="comment"><sp/><sp/><sp/><sp/>as<sp/>follows.<sp/>Let<sp/>r<sp/>and<sp/>i<sp/>be<sp/>copies<sp/>of<sp/>the<sp/>rounding<sp/>mode<sp/>and</highlight></codeline>
<codeline lineno="386"><highlight class="comment"><sp/><sp/><sp/><sp/>inexact<sp/>flag<sp/>before<sp/>entering<sp/>the<sp/>square<sp/>root<sp/>program.<sp/>Also<sp/>we</highlight></codeline>
<codeline lineno="387"><highlight class="comment"><sp/><sp/><sp/><sp/>use<sp/>the<sp/>expression<sp/>y+-ulp<sp/>for<sp/>the<sp/>next<sp/>representable<sp/>floating</highlight></codeline>
<codeline lineno="388"><highlight class="comment"><sp/><sp/><sp/><sp/>numbers<sp/>(up<sp/>and<sp/>down)<sp/>of<sp/>y.<sp/>Note<sp/>that<sp/>y+-ulp<sp/>=<sp/>either<sp/>fixed</highlight></codeline>
<codeline lineno="389"><highlight class="comment"><sp/><sp/><sp/><sp/>point<sp/>y+-1,<sp/>or<sp/>multiply<sp/>y<sp/>by<sp/>nextafter(1,+-inf)<sp/>in<sp/>chopped</highlight></codeline>
<codeline lineno="390"><highlight class="comment"><sp/><sp/><sp/><sp/>mode.</highlight></codeline>
<codeline lineno="391"><highlight class="comment"></highlight></codeline>
<codeline lineno="392"><highlight class="comment"><sp/><sp/><sp/><sp/>R<sp/>:=<sp/>RZ;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>set<sp/>rounding<sp/>mode<sp/>to<sp/>round-toward-zero</highlight></codeline>
<codeline lineno="393"><highlight class="comment"><sp/><sp/><sp/><sp/>switch(r)<sp/>{</highlight></codeline>
<codeline lineno="394"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>RN:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>round-to-nearest</highlight></codeline>
<codeline lineno="395"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(x&lt;=<sp/>z*(z-ulp)...chopped)<sp/>z<sp/>=<sp/>z<sp/>-<sp/>ulp;<sp/>else</highlight></codeline>
<codeline lineno="396"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(x&lt;=<sp/>z*(z+ulp)...chopped)<sp/>z<sp/>=<sp/>z;<sp/>else<sp/>z<sp/>=<sp/>z+ulp;</highlight></codeline>
<codeline lineno="397"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break;</highlight></codeline>
<codeline lineno="398"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>RZ:case<sp/>RM:<sp/><sp/><sp/><sp/>...<sp/>round-to-zero<sp/>or<sp/>round-to--inf</highlight></codeline>
<codeline lineno="399"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R:=RP;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>reset<sp/>rounding<sp/>mod<sp/>to<sp/>round-to-+inf</highlight></codeline>
<codeline lineno="400"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(x&lt;z*z<sp/>...<sp/>rounded<sp/>up)<sp/>z<sp/>=<sp/>z<sp/>-<sp/>ulp;<sp/>else</highlight></codeline>
<codeline lineno="401"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(x&gt;=(z+ulp)*(z+ulp)<sp/>...rounded<sp/>up)<sp/>z<sp/>=<sp/>z+ulp;</highlight></codeline>
<codeline lineno="402"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break;</highlight></codeline>
<codeline lineno="403"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>RP:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>round-to-+inf</highlight></codeline>
<codeline lineno="404"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(x&gt;(z+ulp)*(z+ulp)...chopped)<sp/>z<sp/>=<sp/>z+2*ulp;<sp/>else</highlight></codeline>
<codeline lineno="405"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(x&gt;z*z<sp/>...chopped)<sp/>z<sp/>=<sp/>z+ulp;</highlight></codeline>
<codeline lineno="406"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break;</highlight></codeline>
<codeline lineno="407"><highlight class="comment"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="408"><highlight class="comment"></highlight></codeline>
<codeline lineno="409"><highlight class="comment"><sp/><sp/><sp/><sp/>Remark<sp/>3.<sp/>The<sp/>above<sp/>comparisons<sp/>can<sp/>be<sp/>done<sp/>in<sp/>fixed<sp/>point.<sp/>For</highlight></codeline>
<codeline lineno="410"><highlight class="comment"><sp/><sp/><sp/><sp/>example,<sp/>to<sp/>compare<sp/>x<sp/>and<sp/>w=z*z<sp/>chopped,<sp/>it<sp/>suffices<sp/>to<sp/>compare</highlight></codeline>
<codeline lineno="411"><highlight class="comment"><sp/><sp/><sp/><sp/>x1<sp/>and<sp/>w1<sp/>(the<sp/>trailing<sp/>parts<sp/>of<sp/>x<sp/>and<sp/>w),<sp/>regarding<sp/>them<sp/>as</highlight></codeline>
<codeline lineno="412"><highlight class="comment"><sp/><sp/><sp/><sp/>two&apos;s<sp/>complement<sp/>integers.</highlight></codeline>
<codeline lineno="413"><highlight class="comment"></highlight></codeline>
<codeline lineno="414"><highlight class="comment"><sp/><sp/><sp/><sp/>...Is<sp/>z<sp/>an<sp/>exact<sp/>square<sp/>root?</highlight></codeline>
<codeline lineno="415"><highlight class="comment"><sp/><sp/><sp/><sp/>To<sp/>determine<sp/>whether<sp/>z<sp/>is<sp/>an<sp/>exact<sp/>square<sp/>root<sp/>of<sp/>x,<sp/>let<sp/>z1<sp/>be<sp/>the</highlight></codeline>
<codeline lineno="416"><highlight class="comment"><sp/><sp/><sp/><sp/>trailing<sp/>part<sp/>of<sp/>z,<sp/>and<sp/>also<sp/>let<sp/>x0<sp/>and<sp/>x1<sp/>be<sp/>the<sp/>leading<sp/>and</highlight></codeline>
<codeline lineno="417"><highlight class="comment"><sp/><sp/><sp/><sp/>trailing<sp/>parts<sp/>of<sp/>x.</highlight></codeline>
<codeline lineno="418"><highlight class="comment"></highlight></codeline>
<codeline lineno="419"><highlight class="comment"><sp/><sp/><sp/><sp/>If<sp/>((z1&amp;0x03ffffff)!=0)<sp/>...<sp/>not<sp/>exact<sp/>if<sp/>trailing<sp/>26<sp/>bits<sp/>of<sp/>z!=0</highlight></codeline>
<codeline lineno="420"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>:=<sp/>1;<sp/><sp/><sp/><sp/><sp/>...<sp/>Raise<sp/>Inexact<sp/>flag:<sp/>z<sp/>is<sp/>not<sp/>exact</highlight></codeline>
<codeline lineno="421"><highlight class="comment"><sp/><sp/><sp/><sp/>else<sp/>{</highlight></codeline>
<codeline lineno="422"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>:=<sp/>1<sp/>-<sp/>[(x0&gt;&gt;20)&amp;1]<sp/><sp/><sp/>...<sp/>j<sp/>=<sp/>logb(x)<sp/>mod<sp/>2</highlight></codeline>
<codeline lineno="423"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k<sp/>:=<sp/>z1<sp/>&gt;&gt;<sp/>26;<sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>get<sp/>z&apos;s<sp/>25-th<sp/>and<sp/>26-th<sp/></highlight></codeline>
<codeline lineno="424"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fraction<sp/>bits</highlight></codeline>
<codeline lineno="425"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>:=<sp/>i<sp/>or<sp/>(k&amp;j)<sp/>or<sp/>((k&amp;(j+j+1))!=(x1&amp;3));</highlight></codeline>
<codeline lineno="426"><highlight class="comment"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="comment"><sp/><sp/><sp/><sp/>R:=<sp/>r<sp/><sp/><sp/><sp/><sp/><sp/><sp/>...<sp/>restore<sp/>rounded<sp/>mode</highlight></codeline>
<codeline lineno="428"><highlight class="comment"><sp/><sp/><sp/><sp/>return<sp/>sqrt(x):=z.</highlight></codeline>
<codeline lineno="429"><highlight class="comment"></highlight></codeline>
<codeline lineno="430"><highlight class="comment"><sp/><sp/><sp/><sp/>If<sp/>multiplication<sp/>is<sp/>cheaper<sp/>then<sp/>the<sp/>foregoing<sp/>red<sp/>tape,<sp/>the<sp/></highlight></codeline>
<codeline lineno="431"><highlight class="comment"><sp/><sp/><sp/><sp/>Inexact<sp/>flag<sp/>can<sp/>be<sp/>evaluated<sp/>by</highlight></codeline>
<codeline lineno="432"><highlight class="comment"></highlight></codeline>
<codeline lineno="433"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>:=<sp/>i;</highlight></codeline>
<codeline lineno="434"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>:=<sp/>(z*z!=x)<sp/>or<sp/>I.</highlight></codeline>
<codeline lineno="435"><highlight class="comment"></highlight></codeline>
<codeline lineno="436"><highlight class="comment"><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>z*z<sp/>can<sp/>overwrite<sp/>I;<sp/>this<sp/>value<sp/>must<sp/>be<sp/>sensed<sp/>if<sp/>it<sp/>is<sp/></highlight></codeline>
<codeline lineno="437"><highlight class="comment"><sp/><sp/><sp/><sp/>True.</highlight></codeline>
<codeline lineno="438"><highlight class="comment"></highlight></codeline>
<codeline lineno="439"><highlight class="comment"><sp/><sp/><sp/><sp/>Remark<sp/>4.<sp/>If<sp/>z*z<sp/>=<sp/>x<sp/>exactly,<sp/>then<sp/>bit<sp/>25<sp/>to<sp/>bit<sp/>0<sp/>of<sp/>z1<sp/>must<sp/>be</highlight></codeline>
<codeline lineno="440"><highlight class="comment"><sp/><sp/><sp/><sp/>zero.</highlight></codeline>
<codeline lineno="441"><highlight class="comment"></highlight></codeline>
<codeline lineno="442"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--------------------</highlight></codeline>
<codeline lineno="443"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z1:<sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/></highlight></codeline>
<codeline lineno="444"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--------------------</highlight></codeline>
<codeline lineno="445"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit<sp/>31<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit<sp/>0</highlight></codeline>
<codeline lineno="446"><highlight class="comment"></highlight></codeline>
<codeline lineno="447"><highlight class="comment"><sp/><sp/><sp/><sp/>Further<sp/>more,<sp/>bit<sp/>27<sp/>and<sp/>26<sp/>of<sp/>z1,<sp/>bit<sp/>0<sp/>and<sp/>1<sp/>of<sp/>x1,<sp/>and<sp/>the<sp/>odd</highlight></codeline>
<codeline lineno="448"><highlight class="comment"><sp/><sp/><sp/><sp/>or<sp/>even<sp/>of<sp/>logb(x)<sp/>have<sp/>the<sp/>following<sp/>relations:</highlight></codeline>
<codeline lineno="449"><highlight class="comment"></highlight></codeline>
<codeline lineno="450"><highlight class="comment"><sp/><sp/><sp/><sp/>-------------------------------------------------</highlight></codeline>
<codeline lineno="451"><highlight class="comment"><sp/><sp/><sp/><sp/>bit<sp/>27,26<sp/>of<sp/>z1<sp/><sp/><sp/><sp/><sp/>bit<sp/>1,0<sp/>of<sp/>x1<sp/><sp/><sp/>logb(x)</highlight></codeline>
<codeline lineno="452"><highlight class="comment"><sp/><sp/><sp/><sp/>-------------------------------------------------</highlight></codeline>
<codeline lineno="453"><highlight class="comment"><sp/><sp/><sp/><sp/>00<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>00<sp/><sp/><sp/><sp/><sp/><sp/>odd<sp/>and<sp/>even</highlight></codeline>
<codeline lineno="454"><highlight class="comment"><sp/><sp/><sp/><sp/>01<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>01<sp/><sp/><sp/><sp/><sp/><sp/>even</highlight></codeline>
<codeline lineno="455"><highlight class="comment"><sp/><sp/><sp/><sp/>10<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>10<sp/><sp/><sp/><sp/><sp/><sp/>odd</highlight></codeline>
<codeline lineno="456"><highlight class="comment"><sp/><sp/><sp/><sp/>10<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>00<sp/><sp/><sp/><sp/><sp/><sp/>even</highlight></codeline>
<codeline lineno="457"><highlight class="comment"><sp/><sp/><sp/><sp/>11<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>01<sp/><sp/><sp/><sp/><sp/><sp/>even</highlight></codeline>
<codeline lineno="458"><highlight class="comment"><sp/><sp/><sp/><sp/>-------------------------------------------------</highlight></codeline>
<codeline lineno="459"><highlight class="comment"></highlight></codeline>
<codeline lineno="460"><highlight class="comment"><sp/><sp/><sp/><sp/>(4)<sp/>Special<sp/>cases<sp/>(see<sp/>(4)<sp/>of<sp/>Section<sp/>A).<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="461"><highlight class="comment"><sp/></highlight></codeline>
<codeline lineno="462"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_No_Floating_Point<sp/><sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="decomp/CodeWarrior/PowerPC_EABI_Support/Msl/MSL_C/MSL_Common_Embedded/Math/Double_precision/e_sqrt.c"/>
  </compounddef>
</doxygen>
